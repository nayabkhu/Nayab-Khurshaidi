gdp_and_judicial <- merge(gdp_and_judicial, long_fertility, by = c("state_code", "year"), all.x = TRUE)
gdp_and_judicial <- gdp_and_judicial%>%
select(-State.y) %>%
rename(State = State.x)
gdp_and_judicial <- gdp_and_judicial %>%
mutate(diff_acquittal = male_def_acquittal_rate - female_def_acquittal_rate,
diff_dismissal = male_def_dismissal_rate - female_def_dismissal_rate,
diff_conviction = male_def_conviction_rate - female_def_conviction_rate)
populationgrowth <- read_xlsx("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/Data Cleaning/populaitongrowthrate.XLSX")
View(populationgrowth)
sapply(populationgrowth, class)
populationgrowth <- read_xlsx("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/Data Cleaning/populaitongrowthrate.XLSX")
long_growth <- pivot_longer(populationgrowth, cols = `2011`:`2020`,
names_to = "year", values_to = "pop_growth")
long_growth
populationgrowth <- read_xlsx("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/Data Cleaning/populaitongrowthrate.XLSX")
long_growth <- pivot_longer(populationgrowth, cols = `2011`:`2020`,
names_to = "year", values_to = "pop_growth")
long_growth <- long_growth %>%
mutate(pop_growth = ifelse(tfr == ".", NA, pop_growth))
populationgrowth <- read_xlsx("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/Data Cleaning/populaitongrowthrate.XLSX")
long_growth <- pivot_longer(populationgrowth, cols = `2011`:`2020`,
names_to = "year", values_to = "pop_growth")
long_growth <- long_growth %>%
mutate(pop_growth = ifelse(pop_growth == ".", NA, pop_growth))
long_growth <- long_growth %>%
mutate(pop_growth = as.numeric(pop_growth))
state_codes <- c("Maharashtra" = 1, "Andhra Pradesh" = 2, "Karnataka" = 3, "Kerala" = 4, "Himachal Pradesh" = 5,
"Assam" = 6, "Jharkhand" = 7, "Bihar" = 8, "Rajasthan" = 9, "Tamil Nadu" = 10,
"Odisha" = 11, "Uttar Pradesh" = 13, "Haryana" = 14,
"Uttarakhand" = 15, "West Bengal" = 16, "Gujarat" = 17, "Chhattisgarh" = 18,
"Mizoram" = 19, "Tripura" = 20, "Meghalaya" = 21, "Punjab" = 22, "Madhya Pradesh" = 23,
"Sikkim" = 24, "Manipur" = 25, "Delhi" = 26, "Chandigarh" = 27, "Telangana" = 29,
"Goa" = 30)
# Assign codes to states in the dataset and remove states not in the key
long_growth$state_code <- state_codes[long_growth$State]
long_growt
long_growth
populationgrowth <- read_xlsx("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/Data Cleaning/populaitongrowthrate.XLSX")
long_growth <- pivot_longer(populationgrowth, cols = `2011`:`2020`,
names_to = "year", values_to = "pop_growth")
long_growth <- long_growth %>%
mutate(pop_growth = ifelse(pop_growth == ".", NA, pop_growth))
long_growth <- long_growth %>%
mutate(pop_growth = as.numeric(pop_growth))
state_codes <- c("Maharashtra" = 1, "Andhra Pradesh" = 2, "Karnataka" = 3, "Kerala" = 4, "Himachal Pradesh" = 5,
"Assam" = 6, "Jharkhand" = 7, "Bihar" = 8, "Rajasthan" = 9, "Tamil Nadu" = 10,
"Odisha" = 11, "Uttar Pradesh" = 13, "Haryana" = 14,
"Uttarakhand" = 15, "West Bengal" = 16, "Gujarat" = 17, "Chhattisgarh" = 18,
"Mizoram" = 19, "Tripura" = 20, "Meghalaya" = 21, "Punjab" = 22, "Madhya Pradesh" = 23,
"Sikkim" = 24, "Manipur" = 25, "Delhi" = 26, "Chandigarh" = 27, "Telangana" = 29,
"Goa" = 30)
# Assign codes to states in the dataset and remove states not in the key
long_growth$state_code <- state_codes[long_growth$State]
gdp_and_judicial <- merge(gdp_and_judicial, long_growth, by = c("state_code", "year"), all.x = TRUE)
gdp_and_judicial <- gdp_and_judicial%>%
select(-State.y) %>%
rename(State = State.x)
gdp_and_judicial
write.csv(gdp_and_judicial, "/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/Data Cleaning/gdp_and_judicial.csv", row.names = FALSE)
library(dplyr)
library(gt)
library(psych)
library(ggplot2)
library(modelsummary)
#load in data
df <- read.csv("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/gdp_and_judicial.csv")
#generating summary statistics for the key variables
summary <- describe(df[ , c('diff_acquittal', 'diff_dismissal', 'diff_conviction', 'GDP')], fast=TRUE)
#remove the unecessary variables
summary <- summary %>%
select(-c("vars", "skew", "kurtosis"))
#rounding all the variables in the table
summary  <- summary %>%
mutate(across(everything(), ~round(., 2)))
#formatting the table
summary <- summary %>%
mutate(row_names = row.names(.))
last_col <- summary[, ncol(summary)]
summary <- summary[, -ncol(summary)]
# Add the last column as the first column
summary <- cbind(last_col, summary)
names(summary)[1] <- "Variable"
gt_tbl1 <- gt(summary)
# Add title
gt_tbl1 <- gt_tbl1 %>%
tab_header(
title = "Summary Statistics for Key Variables")
gt_tbl1
#| warning: false
#ggplot of variables and gdp
# Scatterplot for diff_acquittal vs. gdp
plot_acquittal <- ggplot(df, aes(x = diff_acquittal, y = GDP)) +
geom_point() +
#add a line of best fit
geom_smooth(method = "loess", se = FALSE, color = "blue") +
#add a line at the x = 0
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
#adding clarifying variable
geom_text(aes(x = -4, y = 2750000, label = "Higher Acquittal Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 7.5, y = 2750000, label = "Higher Acquittal Rates\n for Men"), hjust = 0.5, vjust = 1) +
#adding titles and a caption
labs(
title = "Diffirence in Acquittal Rate  vs. GDP",
x = "Difference in Acquittal Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Acquittal variable and statewide GDP.The Diff_Acquittal \n variable was generated by subtracting the Acquittal Rate for Female Defendants from the Acquittal Rate for Male \n Defendants. A positive difference indicates that men were acquitted more, on average, then women. A negative\n difference indicates that women were acquitted at higher rates then men. A simple line of best fit shows a slight \n negative correlation between the difference in acquittal rate and GDP.  N = 224 "
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
# Scatterplot for diff_dismissal vs. gdp
plot_dismissal <- ggplot(df, aes(x = diff_dismissal, y = GDP )) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
geom_text(aes(x = -10, y = 2750000, label = "Higher Dismissal Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 3, y = 2750000, label = "Higher Dismissal Rates\n for Men"), hjust = 0.5, vjust = 1) +
labs(
title = "Difference in Dismissal Rate vs. GDP",
x = "Difference in Dismissal Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Dismissal variable and statewide GDP.The Diff_Dismissal \n variable was generated by subtracting the Dismissal Rate for Female Defendants from the Dismissal Rate for Male \n Defendants. A positive difference indicates that men were dismissed more, on average, then women. A negative\n difference indicates that women were dismissed at higher rates then men. A simple line of best fit shows a  very slight \n positive correlation between the difference in dismissal rate and GDP.  N = 224 "
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
# Scatterplot for diff_conviction vs. gdp
plot_conviction <- ggplot(df, aes(x = diff_conviction, y = GDP)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
geom_text(aes(x = -4, y = 2750000, label = "Higher Conviction Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 6, y = 2750000, label = "Higher Conviction Rates\n for Men"), hjust = 0.5, vjust = 1) +
labs(
title = "Difference in Conviction Rate vs. GDP",
x = "Difference in Conviction Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Conviction variable and statewide GDP.The Diff_Conviction \n variable was generated by subtracting the Conviction Rate for Female Defendants from the Conviction Rate for Male \n Defendants. A positive difference indicates that men were convicted more, on average, then women. A negative\n difference indicates that women were convicted at higher rates then men. A simple line of best fit shows a slight \n positive correlation between the difference in conviction rate and GDP.  N = 224"
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
#| warning: false
plot_acquittal
#| warning: false
plot_dismissal
#| warning: false
plot_conviction
#generating summary statistics for the key variables
summary2 <- describe(df[ , c('mmr', 'tfr', 'unemr')], fast=TRUE)
#remove the unecessary variables
summary2 <- summary2 %>%
select(-c("vars", "skew", "kurtosis"))
#rounding all the variables in the table
summary2  <- summary2 %>%
mutate(across(everything(), ~round(., 2)))
#formatting the table
summary2 <- summary2 %>%
mutate(row_names = row.names(.))
last_col2 <- summary2[, ncol(summary2)]
summary2 <- summary2[, -ncol(summary2)]
# Add the last column as the first column
summary2 <- cbind(last_col2, summary2)
names(summary2)[1] <- "Variable"
summary2 <- summary2 %>%
mutate(Variable = case_when(
Variable == "mmr" ~ "Maternal Mortality Ratio",
Variable == "tfr" ~ "Total Fertility Rate",
Variable == "unemr" ~ "Female Unemployment Rate",
TRUE ~ Variable  # Keep the original value if none of the conditions are met
))
gt_tbl2 <- gt(summary2)
# Add title
gt_tbl2 <- gt_tbl2 %>%
tab_header(
title = "Summary Statistics for Empirical Extension Variables")
gt_tbl2
model1 <- lm(GDP ~ diff_acquittal, data = df)
modelsummary(
model1,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
model2 <- lm(GDP ~ diff_acquittal + (diff_acquittal)^2, data = df)
modelsummary(
model2,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
modelcontrol <- lm(GDP ~ diff_acquittal + pop_growth, data = df)
View(df)
#load in data
df <- read.csv("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/gdp_and_judicial.csv")
library(dplyr)
library(gt)
library(psych)
library(ggplot2)
library(modelsummary)
#load in data
df <- read.csv("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/gdp_and_judicial.csv")
#generating summary statistics for the key variables
summary <- describe(df[ , c('diff_acquittal', 'diff_dismissal', 'diff_conviction', 'GDP')], fast=TRUE)
#remove the unecessary variables
summary <- summary %>%
select(-c("vars", "skew", "kurtosis"))
#rounding all the variables in the table
summary  <- summary %>%
mutate(across(everything(), ~round(., 2)))
#formatting the table
summary <- summary %>%
mutate(row_names = row.names(.))
last_col <- summary[, ncol(summary)]
summary <- summary[, -ncol(summary)]
# Add the last column as the first column
summary <- cbind(last_col, summary)
names(summary)[1] <- "Variable"
gt_tbl1 <- gt(summary)
# Add title
gt_tbl1 <- gt_tbl1 %>%
tab_header(
title = "Summary Statistics for Key Variables")
gt_tbl1
#| warning: false
#ggplot of variables and gdp
# Scatterplot for diff_acquittal vs. gdp
plot_acquittal <- ggplot(df, aes(x = diff_acquittal, y = GDP)) +
geom_point() +
#add a line of best fit
geom_smooth(method = "loess", se = FALSE, color = "blue") +
#add a line at the x = 0
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
#adding clarifying variable
geom_text(aes(x = -4, y = 2750000, label = "Higher Acquittal Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 7.5, y = 2750000, label = "Higher Acquittal Rates\n for Men"), hjust = 0.5, vjust = 1) +
#adding titles and a caption
labs(
title = "Diffirence in Acquittal Rate  vs. GDP",
x = "Difference in Acquittal Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Acquittal variable and statewide GDP.The Diff_Acquittal \n variable was generated by subtracting the Acquittal Rate for Female Defendants from the Acquittal Rate for Male \n Defendants. A positive difference indicates that men were acquitted more, on average, then women. A negative\n difference indicates that women were acquitted at higher rates then men. A simple line of best fit shows a slight \n negative correlation between the difference in acquittal rate and GDP.  N = 224 "
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
# Scatterplot for diff_dismissal vs. gdp
plot_dismissal <- ggplot(df, aes(x = diff_dismissal, y = GDP )) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
geom_text(aes(x = -10, y = 2750000, label = "Higher Dismissal Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 3, y = 2750000, label = "Higher Dismissal Rates\n for Men"), hjust = 0.5, vjust = 1) +
labs(
title = "Difference in Dismissal Rate vs. GDP",
x = "Difference in Dismissal Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Dismissal variable and statewide GDP.The Diff_Dismissal \n variable was generated by subtracting the Dismissal Rate for Female Defendants from the Dismissal Rate for Male \n Defendants. A positive difference indicates that men were dismissed more, on average, then women. A negative\n difference indicates that women were dismissed at higher rates then men. A simple line of best fit shows a  very slight \n positive correlation between the difference in dismissal rate and GDP.  N = 224 "
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
# Scatterplot for diff_conviction vs. gdp
plot_conviction <- ggplot(df, aes(x = diff_conviction, y = GDP)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
geom_text(aes(x = -4, y = 2750000, label = "Higher Conviction Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 6, y = 2750000, label = "Higher Conviction Rates\n for Men"), hjust = 0.5, vjust = 1) +
labs(
title = "Difference in Conviction Rate vs. GDP",
x = "Difference in Conviction Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Conviction variable and statewide GDP.The Diff_Conviction \n variable was generated by subtracting the Conviction Rate for Female Defendants from the Conviction Rate for Male \n Defendants. A positive difference indicates that men were convicted more, on average, then women. A negative\n difference indicates that women were convicted at higher rates then men. A simple line of best fit shows a slight \n positive correlation between the difference in conviction rate and GDP.  N = 224"
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
#| warning: false
plot_acquittal
#| warning: false
plot_dismissal
#| warning: false
plot_conviction
#generating summary statistics for the key variables
summary2 <- describe(df[ , c('mmr', 'tfr', 'unemr')], fast=TRUE)
#remove the unecessary variables
summary2 <- summary2 %>%
select(-c("vars", "skew", "kurtosis"))
#rounding all the variables in the table
summary2  <- summary2 %>%
mutate(across(everything(), ~round(., 2)))
#formatting the table
summary2 <- summary2 %>%
mutate(row_names = row.names(.))
last_col2 <- summary2[, ncol(summary2)]
summary2 <- summary2[, -ncol(summary2)]
# Add the last column as the first column
summary2 <- cbind(last_col2, summary2)
names(summary2)[1] <- "Variable"
summary2 <- summary2 %>%
mutate(Variable = case_when(
Variable == "mmr" ~ "Maternal Mortality Ratio",
Variable == "tfr" ~ "Total Fertility Rate",
Variable == "unemr" ~ "Female Unemployment Rate",
TRUE ~ Variable  # Keep the original value if none of the conditions are met
))
gt_tbl2 <- gt(summary2)
# Add title
gt_tbl2 <- gt_tbl2 %>%
tab_header(
title = "Summary Statistics for Empirical Extension Variables")
gt_tbl2
model1 <- lm(GDP ~ diff_acquittal, data = df)
modelsummary(
model1,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
model2 <- lm(GDP ~ diff_acquittal + (diff_acquittal)^2, data = df)
modelsummary(
model2,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
modelcontrol <- lm(GDP ~ diff_acquittal + pop_growth, data = df)
modelsummary(
modelcontrol,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
df$diff_acquittal_squared <- df$diff_acquittal^2
# Fit the regression model
model2 <- lm(GDP ~ diff_acquittal + diff_acquittal_squared, data = df)
modelsummary(
model2,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
model1 <- lm(GDP ~ diff_acquittal, data = df)
modelsummary(
model1,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.',
title = "Regressison Model, GDP and Difference in Acquittal Rate")
model1 <- lm(GDP ~ diff_acquittal, data = df)
modelsummary(
model1,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.',
title = "GDP and Difference in Acquittal Rate")
library(dplyr)
library(gt)
library(psych)
library(ggplot2)
library(modelsummary)
#load in data
df <- read.csv("/Users/nayabkhurshaidi/Documents/GitHub/Nayab Khurshaidi/Data/gdp_and_judicial.csv")
#generating summary statistics for the key variables
summary <- describe(df[ , c('diff_acquittal', 'diff_dismissal', 'diff_conviction', 'GDP')], fast=TRUE)
#remove the unecessary variables
summary <- summary %>%
select(-c("vars", "skew", "kurtosis"))
#rounding all the variables in the table
summary  <- summary %>%
mutate(across(everything(), ~round(., 2)))
#formatting the table
summary <- summary %>%
mutate(row_names = row.names(.))
last_col <- summary[, ncol(summary)]
summary <- summary[, -ncol(summary)]
# Add the last column as the first column
summary <- cbind(last_col, summary)
names(summary)[1] <- "Variable"
gt_tbl1 <- gt(summary)
# Add title
gt_tbl1 <- gt_tbl1 %>%
tab_header(
title = "Summary Statistics for Key Variables")
gt_tbl1
#| warning: false
#ggplot of variables and gdp
# Scatterplot for diff_acquittal vs. gdp
plot_acquittal <- ggplot(df, aes(x = diff_acquittal, y = GDP)) +
geom_point() +
#add a line of best fit
geom_smooth(method = "loess", se = FALSE, color = "blue") +
#add a line at the x = 0
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
#adding clarifying variable
geom_text(aes(x = -4, y = 2750000, label = "Higher Acquittal Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 7.5, y = 2750000, label = "Higher Acquittal Rates\n for Men"), hjust = 0.5, vjust = 1) +
#adding titles and a caption
labs(
title = "Diffirence in Acquittal Rate  vs. GDP",
x = "Difference in Acquittal Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Acquittal variable and statewide GDP.The Diff_Acquittal \n variable was generated by subtracting the Acquittal Rate for Female Defendants from the Acquittal Rate for Male \n Defendants. A positive difference indicates that men were acquitted more, on average, then women. A negative\n difference indicates that women were acquitted at higher rates then men. A simple line of best fit shows a slight \n negative correlation between the difference in acquittal rate and GDP.  N = 224 "
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
# Scatterplot for diff_dismissal vs. gdp
plot_dismissal <- ggplot(df, aes(x = diff_dismissal, y = GDP )) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
geom_text(aes(x = -10, y = 2750000, label = "Higher Dismissal Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 3, y = 2750000, label = "Higher Dismissal Rates\n for Men"), hjust = 0.5, vjust = 1) +
labs(
title = "Difference in Dismissal Rate vs. GDP",
x = "Difference in Dismissal Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Dismissal variable and statewide GDP.The Diff_Dismissal \n variable was generated by subtracting the Dismissal Rate for Female Defendants from the Dismissal Rate for Male \n Defendants. A positive difference indicates that men were dismissed more, on average, then women. A negative\n difference indicates that women were dismissed at higher rates then men. A simple line of best fit shows a  very slight \n positive correlation between the difference in dismissal rate and GDP.  N = 224 "
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
# Scatterplot for diff_conviction vs. gdp
plot_conviction <- ggplot(df, aes(x = diff_conviction, y = GDP)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
geom_text(aes(x = -4, y = 2750000, label = "Higher Conviction Rates\n for Women"), hjust = 0.5, vjust = 1) +
geom_text(aes(x = 6, y = 2750000, label = "Higher Conviction Rates\n for Men"), hjust = 0.5, vjust = 1) +
labs(
title = "Difference in Conviction Rate vs. GDP",
x = "Difference in Conviction Rates (Male - Female)",
y = "Statewide GDP (Crores)",
caption = "Source: Development Data Lab\nGovernment of India Ministry of Statistics\nNote: This plot shows the relationship between the Diff_Conviction variable and statewide GDP.The Diff_Conviction \n variable was generated by subtracting the Conviction Rate for Female Defendants from the Conviction Rate for Male \n Defendants. A positive difference indicates that men were convicted more, on average, then women. A negative\n difference indicates that women were convicted at higher rates then men. A simple line of best fit shows a slight \n positive correlation between the difference in conviction rate and GDP.  N = 224"
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0)
)
#| warning: false
plot_acquittal
#| warning: false
plot_dismissal
#| warning: false
plot_conviction
#generating summary statistics for the key variables
summary2 <- describe(df[ , c('mmr', 'tfr', 'unemr')], fast=TRUE)
#remove the unecessary variables
summary2 <- summary2 %>%
select(-c("vars", "skew", "kurtosis"))
#rounding all the variables in the table
summary2  <- summary2 %>%
mutate(across(everything(), ~round(., 2)))
#formatting the table
summary2 <- summary2 %>%
mutate(row_names = row.names(.))
last_col2 <- summary2[, ncol(summary2)]
summary2 <- summary2[, -ncol(summary2)]
# Add the last column as the first column
summary2 <- cbind(last_col2, summary2)
names(summary2)[1] <- "Variable"
summary2 <- summary2 %>%
mutate(Variable = case_when(
Variable == "mmr" ~ "Maternal Mortality Ratio",
Variable == "tfr" ~ "Total Fertility Rate",
Variable == "unemr" ~ "Female Unemployment Rate",
TRUE ~ Variable  # Keep the original value if none of the conditions are met
))
gt_tbl2 <- gt(summary2)
# Add title
gt_tbl2 <- gt_tbl2 %>%
tab_header(
title = "Summary Statistics for Empirical Extension Variables")
gt_tbl2
model1 <- lm(GDP ~ diff_acquittal, data = df)
modelsummary(
model1,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.',
title = "GDP and Difference in Acquittal Rate")
df$diff_acquittal_squared <- df$diff_acquittal^2
# Fit the regression model
model2 <- lm(GDP ~ diff_acquittal + diff_acquittal_squared, data = df)
modelsummary(
model2,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
modelcontrol <- lm(GDP ~ diff_acquittal + pop_growth, data = df)
modelsummary(
modelcontrol,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
model3 <- lm(GDP ~ diff_dismissal, data = df)
modelsummary(
model3,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
model4 <- lm(GDP ~ diff_conviction, data = df)
modelsummary(
model4,
estimate  = "{estimate}{stars} ({std.error})",
statistic = NULL,
gof_omit = 'IC|RMSE|Log|F|R2$|Std.')
